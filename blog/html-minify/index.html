<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width" /><meta charSet="utf-8" /><title>自作ブログのHTMLをminifyした | Tech SANDBOX</title><meta name="description" content="HTMLはホワイトスペースの問題があり、minifyする、しないの意見が別れるようだ。私は普段、HTMLまでは行わないのだが、今回はhtml-minifierを使用してHTMLを圧縮したのでそのメモを残しておく。" /><meta property="og:title" content="自作ブログのHTMLをminifyした" /><meta property="og:description" content="HTMLはホワイトスペースの問題があり、minifyする、しないの意見が別れるようだ。私は普段、HTMLまでは行わないのだが、今回はhtml-minifierを使用してHTMLを圧縮したのでそのメモを残しておく。" /><meta property="og:type" content="article" /><meta property="og:url" content="https://imasanari.github.io/blog/html-minify/" /><meta property="og:image" content="https://imasanari.github.io/images/icon.jpg" /><meta property="og:site_name" content="Tech SANDBOX" /><meta name="twitter:card" content="summary" /><meta name="next-head-count" content="11" /><meta charSet="utf-8" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-74494516-4"></script><script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-74494516-4', {
  page_path: window.location.pathname,
});
</script><meta name="google-site-verification" content="UmWq3FQLg72H6H0Tlk-SFR9f0bSBsvC8nDmxtK3-qMc" /><meta name="next-font-preconnect" /><link rel="amphtml" href="/blog/html-minify.amp" /><noscript data-n-css></noscript><script defer noModule src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-676b634df3a2e97f.js" defer></script><script src="/_next/static/chunks/framework-e76b485c20171e26.js" defer></script><script src="/_next/static/chunks/main-a60c79ca4c9e4a78.js" defer></script><script src="/_next/static/chunks/pages/_app-0bbb6f652fb88496.js" defer></script><script src="/_next/static/chunks/308-8e43d561a1166d21.js" defer></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-80cbff6699981211.js" defer></script><script src="/_next/static/Gve2BknyuSzfI_yPPf3tt/_buildManifest.js" defer></script><script src="/_next/static/Gve2BknyuSzfI_yPPf3tt/_ssgManifest.js" defer></script><script src="/_next/static/Gve2BknyuSzfI_yPPf3tt/_middlewareManifest.js" defer></script><style data-emotion="c-global 15yblv4">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="c 1j2cbpl g7fid7 1ff36h2 1x6wkub 1qeofn3 wb6uyc rntpfg up73zk zjuml4 1dmadst vubbuv 191lty2 1qsxih2 1yjvs5a 1n6wxgb 1qh3bxa 16n8wpk 1ihubty 1772xtw 1bbvdb4 chkhw5 1ugattu y25xid x8nsji 5ck7xs 1lky7cb 15x2j1y 14rm9aa vlahzl 1yipi07 1k33q06 12ogyw6 35e4su cbw5c6 x2rcou pyq1no 1gqug66 1o4go08 qnc63b 1xnox0e nhm5c0 13l5dua 1aue7hj nkh4ut q1nw06 1hdf6gm 1hbvs7c 1d3ah2d fnf71d 1j6il5h">.c-1j2cbpl{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#f5f5f5;color:rgba(0, 0, 0, 0.87);}@media print{.c-1j2cbpl{position:absolute;}}.c-g7fid7{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:56px;}@media (min-width:600px){.c-g7fid7{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.c-g7fid7{max-width:1200px;}}@media (min-width:0px) and (orientation: landscape){.c-g7fid7{min-height:48px;}}@media (min-width:600px){.c-g7fid7{min-height:64px;}}.c-1ff36h2{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}.c-1x6wkub{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.c-1qeofn3{margin:0;color:inherit;-webkit-text-decoration:none;text-decoration:none;}.c-wb6uyc{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}@media (min-width:0px){.c-rntpfg{display:none;}}@media (min-width:600px){.c-rntpfg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.c-up73zk{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:inherit;margin-left:24px;-webkit-text-decoration:underline;text-decoration:underline;}.c-up73zk:hover{text-decoration-color:inherit;}@media (min-width:0px){.c-zjuml4{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}@media (min-width:600px){.c-zjuml4{display:none;}}.c-1dmadst{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;margin-right:-12px;color:inherit;padding:12px;font-size:1.75rem;}.c-1dmadst::-moz-focus-inner{border-style:none;}.c-1dmadst.Mui-disabled{pointer-events:none;cursor:default;}@media print{.c-1dmadst{-webkit-print-color-adjust:exact;color-adjust:exact;}}.c-1dmadst:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.c-1dmadst:hover{background-color:transparent;}}.c-1dmadst.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}.c-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}.c-191lty2{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:16px;padding-right:16px;min-height:56px;}@media (min-width:600px){.c-191lty2{padding-left:24px;padding-right:24px;}}@media (min-width:0px) and (orientation: landscape){.c-191lty2{min-height:48px;}}@media (min-width:600px){.c-191lty2{min-height:64px;}}.c-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.c-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.c-1qsxih2{max-width:1200px;}}.c-1yjvs5a{margin-bottom:32px;}.c-1n6wxgb{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:8px 0px;}.c-1qh3bxa{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.25rem;margin-right:4px;}.c-16n8wpk{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;}.c-1ihubty{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1.5rem;line-height:1.334;margin-bottom:0.35em;}.c-1772xtw{padding:0;margin:0;}.c-1bbvdb4{display:inline;padding:0;margin:0;}.c-chkhw5{margin:0;color:rgba(0, 0, 0, 0.6);-webkit-text-decoration:none;text-decoration:none;}.c-chkhw5:hover{-webkit-text-decoration:underline;text-decoration:underline;}.c-1ugattu{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:2.125rem;line-height:1.235;margin-top:32px;margin-bottom:32px;border-bottom:1px solid currentcolor;}.c-y25xid{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;margin-top:16px;margin-bottom:16px;text-align:justify;white-space:pre-line;}.c-x8nsji{margin:0;color:#1976d2;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(25, 118, 210, 0.4);}.c-x8nsji:hover{text-decoration-color:inherit;}.c-5ck7xs{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;margin-top:16px;margin-bottom:16px;}.c-5ck7xs .c-5ck7xs{margin-top:0;margin-bottom:0;}.c-1lky7cb{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;}.c-15x2j1y{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1.5rem;line-height:1.334;margin-top:24px;margin-bottom:24px;}.c-14rm9aa{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);margin-top:16px;margin-bottom:16px;}.c-vlahzl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:4px 32px;border-top-right-radius:5px;border-top-left-radius:5px;background-color:#555;color:white;}.c-1yipi07{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;padding:5px;font-size:1.125rem;color:white;}.c-1yipi07::-moz-focus-inner{border-style:none;}.c-1yipi07.Mui-disabled{pointer-events:none;cursor:default;}@media print{.c-1yipi07{-webkit-print-color-adjust:exact;color-adjust:exact;}}.c-1yipi07:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.c-1yipi07:hover{background-color:transparent;}}.c-1yipi07.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}.c-1k33q06{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.25rem;}.c-12ogyw6{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;overflow:auto;padding:8px 32px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;}.c-35e4su{padding:4px 8px;border-radius:4px;background-color:#1e1e1e;color:#d4d4d4;font-family:"SFMono-Regular",Consolas,Menlo,Courier,monospace,monospace;font-size:0.9em;}pre>.c-35e4su{padding:0;background-color:transparent;}.c-cbw5c6{padding:4px 8px;border-radius:4px;background-color:#1e1e1e;color:#d4d4d4;font-family:"SFMono-Regular",Consolas,Menlo,Courier,monospace,monospace;font-size:0.9em;word-break:break-all;}pre>.c-cbw5c6{padding:0;background-color:transparent;}.c-x2rcou{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;border:1px solid rgba(0, 0, 0, 0.12);width:100%;overflow-x:auto;}.c-pyq1no{display:table;width:100%;border-collapse:collapse;border-spacing:0;}.c-pyq1no caption{font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;padding:16px;color:rgba(0, 0, 0, 0.6);text-align:left;caption-side:bottom;}.c-1gqug66{color:inherit;display:table-row;vertical-align:middle;outline:0;}.c-1gqug66.MuiTableRow-hover:hover{background-color:rgba(0, 0, 0, 0.04);}.c-1gqug66.Mui-selected{background-color:rgba(25, 118, 210, 0.08);}.c-1gqug66.Mui-selected:hover{background-color:rgba(25, 118, 210, 0.12);}.c-1o4go08{font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;display:table-cell;vertical-align:inherit;border-bottom:1px solid rgba(224, 224, 224, 1);text-align:left;padding:16px;}.c-qnc63b{font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;display:table-cell;vertical-align:inherit;border-bottom:1px solid rgba(224, 224, 224, 1);text-align:right;padding:16px;-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;}.c-1xnox0e{display:table-row-group;}.c-nhm5c0{font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;display:table-cell;vertical-align:inherit;border-bottom:1px solid rgba(224, 224, 224, 1);text-align:left;padding:16px;color:rgba(0, 0, 0, 0.87);}.c-13l5dua{font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;display:table-cell;vertical-align:inherit;border-bottom:1px solid rgba(224, 224, 224, 1);text-align:right;padding:16px;color:rgba(0, 0, 0, 0.87);-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;}.c-1aue7hj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:0;margin:32px 0px;}.c-nkh4ut{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px 16px;margin:0;-webkit-flex:1;-ms-flex:1;flex:1;padding-left:0;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;}.c-q1nw06{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;color:#1976d2;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(25, 118, 210, 0.4);}.c-q1nw06:hover{text-decoration-color:inherit;}.c-1hdf6gm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px 16px;margin:0;border-left:1px solid #6c6c6c;border-right:1px solid #6c6c6c;}.c-1hbvs7c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px 16px;margin:0;-webkit-flex:1;-ms-flex:1;flex:1;padding-right:0;}.c-1d3ah2d{text-align:center;margin:32px 0px;}.c-fnf71d{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:1rem;line-height:1.5;margin-bottom:0.35em;}.c-1j6il5h{margin:0;font-family:游ゴシック体,YuGothic,游ゴシック,Yu Gothic,メイリオ,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.43;color:#1976d2;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(25, 118, 210, 0.4);}.c-1j6il5h:hover{text-decoration-color:inherit;}</style></head><body><div id="__next"><header amp-fx="float-in-top" class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation1 MuiAppBar-root MuiAppBar-colorDefault MuiAppBar-positionFixed mui-fixed c-1j2cbpl"><div class="MuiContainer-root MuiContainer-maxWidthLg MuiToolbar-root MuiToolbar-regular c-g7fid7"><div class="c-1ff36h2"><div class="MuiTypography-root MuiTypography-h6 MuiTypography-noWrap c-1x6wkub"><a href="/" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone c-1qeofn3">Tech SANDBOX</a></div><p class="MuiTypography-root MuiTypography-body2 MuiTypography-noWrap c-wb6uyc">技術ブログ改め、Qiitaの下書き</p></div><nav class="MuiBox-root c-rntpfg"><a href="/" class="MuiTypography-root MuiTypography-body1 MuiTypography-noWrap MuiLink-root MuiLink-underlineAlways c-up73zk">Blog</a><a href="https://github.com/iMasanari" target="_blank" rel="noopener" class="MuiTypography-root MuiTypography-body1 MuiTypography-noWrap MuiLink-root MuiLink-underlineAlways c-up73zk">GitHub</a><a href="https://qiita.com/iMasanari" target="_blank" rel="noopener" class="MuiTypography-root MuiTypography-body1 MuiTypography-noWrap MuiLink-root MuiLink-underlineAlways c-up73zk">Qiita</a></nav><div class="MuiBox-root c-zjuml4"><button tabIndex="0" type="button" aria-label="menu" class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-edgeEnd MuiIconButton-sizeLarge c-1dmadst"><svg focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon" class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium c-vubbuv"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button></div></div></header><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular c-191lty2"></div><div class="MuiContainer-root MuiContainer-maxWidthLg c-1qsxih2"><article><div class="MuiBox-root c-1yjvs5a"><header><div class="c-1n6wxgb"><svg focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="CalendarTodayIcon" class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall c-1qh3bxa"><path d="M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"></path></svg><time dateTime="2018-07-29T14:19:54.882Z" class="MuiTypography-root MuiTypography-body2 c-16n8wpk">2018-07-29</time></div><h1 class="MuiTypography-root MuiTypography-h5 MuiTypography-gutterBottom c-1ihubty">自作ブログのHTMLをminifyした</h1><ul class="c-1772xtw"> <li class="c-1bbvdb4"><a href="/tags/html-minifier/" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover c-chkhw5">#html-minifier</a></li></ul></header></div><main><h2 class="MuiTypography-root MuiTypography-h4 c-1ugattu">はじめに</h2>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">HTMLはホワイトスペースの問題があり、minifyする、しないの意見が別れるようだ。私は普段、HTMLまでは行わないのだが、今回は<a href="https://github.com/kangax/html-minifier" target="_blank" rel="noopener" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways c-x8nsji">html-minifier</a>を使用してHTMLを圧縮したのでそのメモを残しておく。</p>
<h2 class="MuiTypography-root MuiTypography-h4 c-1ugattu">動機</h2>
<ul class="MuiTypography-root MuiTypography-body1 c-5ck7xs">
<li class="MuiTypography-root MuiTypography-body1 c-1lky7cb">markdownの変換するHTMLが気に入らない
<ul class="MuiTypography-root MuiTypography-body1 c-5ck7xs">
<li class="MuiTypography-root MuiTypography-body1 c-1lky7cb">改行はあるがインデントはなく、整形が中途半端</li>
<li class="MuiTypography-root MuiTypography-body1 c-1lky7cb">minifyして綺麗にしよう！</li>
</ul>
</li>
<li class="MuiTypography-root MuiTypography-body1 c-1lky7cb">軽量化
<ul class="MuiTypography-root MuiTypography-body1 c-5ck7xs">
<li class="MuiTypography-root MuiTypography-body1 c-1lky7cb">Hyperappにしたので、軽さにはこだわりたい</li>
</ul>
</li>
</ul>
<h2 class="MuiTypography-root MuiTypography-h4 c-1ugattu">設定</h2>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">このブログのHTMLは、Hyperappで生成される部分とmarkdownで生成される部分の2つがある。今回はそれぞれ別の設定でminifyを行った。</p>
<h3 class="MuiTypography-root MuiTypography-h5 c-15x2j1y">Hyperapp / HTML</h3>
<div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation4 c-14rm9aa"><div class="c-vlahzl"><span class="MuiTypography-root MuiTypography-body1 c-1lky7cb"></span><button tabIndex="0" type="button" aria-label="copy" class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall c-1yipi07"><svg focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon" class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall c-1k33q06"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div><pre style="background-color: #1E1E1E;" class="MuiTypography-root MuiTypography-body1 shiki c-12ogyw6"><code class="c-35e4su"><span class="line"><span style="color: #D4D4D4;">{</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">minifyCSS</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">minifyJS</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">removeAttributeQuotes</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">sortAttributes</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">sortClassName</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">}</span></span></code></pre></div>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">この設定は、Hyperappが事前レンダリングで生成したHTMLに対して行うものである。Virtual DOMから生成されるHTMLには不必要な空白はなく、また実際のDOMとズレているとエラーになりうるので破壊的な変更は行っていない。なので、プロダクションビルド時にのみ行っている。</p>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid"><code class="c-cbw5c6">minifyJS</code>は埋め込まれたHyperappの初期state用の設定だ。JSON形式で埋め込まれるため、その余分なクォートを取り除いている。</p>
<div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation4 c-14rm9aa"><div class="c-vlahzl"><span class="MuiTypography-root MuiTypography-body1 c-1lky7cb"></span><button tabIndex="0" type="button" aria-label="copy" class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall c-1yipi07"><svg focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon" class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall c-1k33q06"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div><pre style="background-color: #1E1E1E;" class="MuiTypography-root MuiTypography-body1 shiki c-12ogyw6"><code class="c-35e4su"><span class="line"><span style="color: #CE9178;">-var __data = {&quot;foo&quot;: &quot;bar&quot;}</span></span>
<span class="line"><span style="color: #B5CEA8;">+var __data = {foo: &quot;bar&quot;}</span></span></code></pre></div>
<h3 class="MuiTypography-root MuiTypography-h5 c-15x2j1y">markdown / JSON</h3>
<div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation4 c-14rm9aa"><div class="c-vlahzl"><span class="MuiTypography-root MuiTypography-body1 c-1lky7cb"></span><button tabIndex="0" type="button" aria-label="copy" class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall c-1yipi07"><svg focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon" class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall c-1k33q06"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div><pre style="background-color: #1E1E1E;" class="MuiTypography-root MuiTypography-body1 shiki c-12ogyw6"><code class="c-35e4su"><span class="line"><span style="color: #D4D4D4;">{</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">collapseBooleanAttributes</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #6A9955;">// collapseInlineTagWhitespace: true,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">collapseWhitespace</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">quoteCharacter</span><span style="color: #D4D4D4;">: </span><span style="color: #CE9178;">`'`</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">removeAttributeQuotes</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">removeRedundantAttributes</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">sortAttributes</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">  </span><span style="color: #C8C8C8;">sortClassName</span><span style="color: #D4D4D4;">: </span><span style="color: #569CD6;">true</span><span style="color: #D4D4D4;">,</span></span>
<span class="line"><span style="color: #D4D4D4;">}</span></span></code></pre></div>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">markdownは、ホワイトスペースの削除など破壊的になりうる設定を取り入れている。これは、Hyperappの<code class="c-cbw5c6">innerHTML</code>で入れているためVirtual DOMの管理外であるからだ。こちらは、破壊箇所がないか様子を見るためにプロダクションビルドでない時にもminifyを行っている。（そのうちプロダクションビルド時のみにしたい）</p>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">最初は、細かい作り込みができないmarkdownでは<code class="c-cbw5c6">collapseInlineTagWhitespace</code>の影響を受けることはないだろうと有効にしていた。しかし、<code class="c-35e4su">**foo** **bar**</code>と書いた時に間のスペースが消えることに気づき、またその設定で効果が出るHTMLをmarkdownが生成するとは思えないのでオフにした。</p>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">また、このHTMLはJSONの中にも埋め込まれることから、シングルクォート使用するよう設定した。</p>
<h2 class="MuiTypography-root MuiTypography-h4 c-1ugattu">採用を断念した設定</h2>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">markdownで<code class="c-cbw5c6">removeOptionalTags</code>というオプションを使用したかったのだが今回の用法では見送った。これは、省略可能なタグを削除するもので、<code class="c-cbw5c6">p</code>や<code class="c-cbw5c6">li</code>の終了タグがその対象の1つだ。</p>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">今回の用法では、markdown時、Hyperapp時と2重にminifyされる。1回目の時に<code class="c-cbw5c6">removeOptionalTags</code>を有効にすると、2回目の時にHTMLが正しくパースされなかった。</p>
<div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation4 c-14rm9aa"><div class="c-vlahzl"><span class="MuiTypography-root MuiTypography-body1 c-1lky7cb"></span><button tabIndex="0" type="button" aria-label="copy" class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall c-1yipi07"><svg focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon" class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall c-1k33q06"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div><pre style="background-color: #1E1E1E;" class="MuiTypography-root MuiTypography-body1 shiki c-12ogyw6"><code class="c-35e4su"><span class="line"><span style="color: #808080;">&lt;</span><span style="color: #569CD6;">p</span><span style="color: #808080;">&gt;</span><span style="color: #D4D4D4;">終了タグは省略</span></span>
<span class="line"><span style="color: #6A9955;">&lt;!-- 終了タグの正しい場所 --&gt;</span></span>
<span class="line"><span style="color: #808080;">&lt;</span><span style="color: #569CD6;">pre</span><span style="color: #808080;">&gt;&lt;</span><span style="color: #569CD6;">code</span><span style="color: #808080;">&gt;</span><span style="color: #D4D4D4;">/* 別のタグ */</span><span style="color: #808080;">&lt;/</span><span style="color: #569CD6;">code</span><span style="color: #808080;">&gt;&lt;/</span><span style="color: #569CD6;">pre</span><span style="color: #808080;">&gt;</span></span>
<span class="line"><span style="color: #6A9955;">&lt;!-- html-minifierが&lt;/p&gt;を挿入した場所 --&gt;</span></span>
<span class="line"><span style="color: #808080;">&lt;</span><span style="color: #569CD6;">p</span><span style="color: #808080;">&gt;</span><span style="color: #D4D4D4;">別のpタグ</span></span></code></pre></div>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">2回目の時にもそのオプションが有効なら間違えて挿入した終了タグも削除された。だが、間違えた状態でminifyされるコードを信頼できないため、<code class="c-cbw5c6">removeOptionalTags</code>は行わないことにした。</p>
<h2 class="MuiTypography-root MuiTypography-h4 c-1ugattu">結果</h2>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid">1つ前の記事<a href="/blog/remove-object-key/" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways c-x8nsji">【ES.next】Objectから任意のキーを削除した新しいObjectを作成する</a>をminifyした。</p>
<div class="MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiTableContainer-root c-x2rcou"><table class="MuiTable-root c-pyq1no">
<thead>
<tr class="MuiTableRow-root c-1gqug66">
<th class="MuiTableCell-root MuiTableCell-alignLeft MuiTableCell-sizeMedium c-1o4go08">設定</th>
<th class="MuiTableCell-root MuiTableCell-alignRight MuiTableCell-sizeMedium c-qnc63b">HTML</th>
<th class="MuiTableCell-root MuiTableCell-alignRight MuiTableCell-sizeMedium c-qnc63b">JSON</th>
</tr>
</thead>
<tbody class="MuiTableBody-root c-1xnox0e">
<tr class="MuiTableRow-root c-1gqug66">
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignLeft MuiTableCell-sizeMedium c-nhm5c0">HTML minifyなし</td>
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignRight MuiTableCell-sizeMedium c-13l5dua">14,170 Byte</td>
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignRight MuiTableCell-sizeMedium c-13l5dua">6,275 Byte</td>
</tr>
<tr class="MuiTableRow-root c-1gqug66">
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignLeft MuiTableCell-sizeMedium c-nhm5c0"><code class="c-cbw5c6">removeOptionalTags</code>なし</td>
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignRight MuiTableCell-sizeMedium c-13l5dua">13,872 Byte</td>
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignRight MuiTableCell-sizeMedium c-13l5dua">6,088 Byte</td>
</tr>
<tr class="MuiTableRow-root c-1gqug66">
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignLeft MuiTableCell-sizeMedium c-nhm5c0"><code class="c-cbw5c6">removeOptionalTags</code>あり</td>
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignRight MuiTableCell-sizeMedium c-13l5dua">13,722 Byte</td>
<td class="MuiTableCell-root MuiTableCell-body MuiTableCell-alignRight MuiTableCell-sizeMedium c-13l5dua">6,037 Byte</td>
</tr>
</tbody>
</table></div>
<p class="MuiTypography-root MuiTypography-body1 c-y25xid"><code class="c-cbw5c6">removeOptionalTags</code>をありにしても元のHTMLの96.8%程度。インデントなしのHTMLをminifyしてもあまり効果はないようだ。
また、<code class="c-cbw5c6">removeOptionalTags</code>の有無もあまり差はなかった。箇条書きを多用すればもう少し差が開く可能性はあるが、わざわざ有効にするほどでもなさそう。</p>
</main></article><ul class="c-1aue7hj"><li class="c-nkh4ut"><a href="/blog/remove-object-key/" class="MuiTypography-root MuiTypography-body1 MuiLink-root MuiLink-underlineAlways c-q1nw06">【ES.next】Objectから任意のキーを削除した新しいObjectを作成する</a></li><li class="c-1hdf6gm"><a href="/" class="MuiTypography-root MuiTypography-body1 MuiLink-root MuiLink-underlineAlways c-q1nw06">HOME</a></li><li class="c-1hbvs7c"><a href="/blog/environment-construction/" class="MuiTypography-root MuiTypography-body1 MuiLink-root MuiLink-underlineAlways c-q1nw06">私の必要最低限な環境構築</a></li></ul></div><footer class="c-1d3ah2d"><div class="MuiContainer-root MuiContainer-maxWidthLg c-1qsxih2"><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom c-fnf71d">Author: <a href="https://github.com/iMasanari" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways c-x8nsji">iMasanari</a></p><a href="https://github.com/iMasanari/imasanari.github.io/" class="MuiTypography-root MuiTypography-body2 MuiLink-root MuiLink-underlineAlways c-1j6il5h">Show on GitHub</a></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"自作ブログのHTMLをminifyした","description":"HTMLはホワイトスペースの問題があり、minifyする、しないの意見が別れるようだ。私は普段、HTMLまでは行わないのだが、今回はhtml-minifierを使用してHTMLを圧縮したのでそのメモを残しておく。","slug":"html-minify","tags":["html-minifier"],"date":"2018-07-29T14:19:54.882Z","update":null,"image":"/images/html-minify.png","draft":false},"next":{"title":"私の必要最低限な環境構築","description":"macOS Mojaveのダークモードに憧れ、Macbookのサブパーテーションにパブリックベータをインストールした。メインのパーテーションに入れるかを検討するため、しばらくはこちらを使用していこうと思う。このパーテーションはHigh Sierraのパブリックベータからのアップデートのため新規インストールではないが、一通り開発できる環境を整え、それをまとめることにする。","slug":"environment-construction","tags":["macOS"],"date":"2018-08-09T15:46:41.052Z","update":"2018-08-31T23:55:19.826Z","image":null,"draft":false},"prev":{"title":"【ES.next】Objectから任意のキーを削除した新しいObjectを作成する","description":"ブログを作る前、Qiitaに投稿しようと書いていたけど途中でやめ、最近まで忘れていた記事です。Qiitaでもいいけど、せっかくだからこっちに置いておきます。","slug":"remove-object-key","tags":["JavaScript","Babel","TypeScript"],"date":"2018-07-13T12:47:36.148Z","update":null,"image":null,"draft":false},"sameTags":[],"content":"\u003ch2\u003eはじめに\u003c/h2\u003e\n\u003cp\u003eHTMLはホワイトスペースの問題があり、minifyする、しないの意見が別れるようだ。私は普段、HTMLまでは行わないのだが、今回は\u003ca href=\"https://github.com/kangax/html-minifier\"\u003ehtml-minifier\u003c/a\u003eを使用してHTMLを圧縮したのでそのメモを残しておく。\u003c/p\u003e\n\u003ch2\u003e動機\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003emarkdownの変換するHTMLが気に入らない\n\u003cul\u003e\n\u003cli\u003e改行はあるがインデントはなく、整形が中途半端\u003c/li\u003e\n\u003cli\u003eminifyして綺麗にしよう！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e軽量化\n\u003cul\u003e\n\u003cli\u003eHyperappにしたので、軽さにはこだわりたい\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e設定\u003c/h2\u003e\n\u003cp\u003eこのブログのHTMLは、Hyperappで生成される部分とmarkdownで生成される部分の2つがある。今回はそれぞれ別の設定でminifyを行った。\u003c/p\u003e\n\u003ch3\u003eHyperapp / HTML\u003c/h3\u003e\n\u003capp-code-wrapper lang=\"js\" code=\"{\n  minifyCSS: true,\n  minifyJS: true,\n  removeAttributeQuotes: true,\n  sortAttributes: true,\n  sortClassName: true,\n}\"\u003e\u003cpre class=\"shiki\" style=\"background-color: #1E1E1E\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003eminifyCSS\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003eminifyJS\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003eremoveAttributeQuotes\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003esortAttributes\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003esortClassName\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/app-code-wrapper\u003e\n\u003cp\u003eこの設定は、Hyperappが事前レンダリングで生成したHTMLに対して行うものである。Virtual DOMから生成されるHTMLには不必要な空白はなく、また実際のDOMとズレているとエラーになりうるので破壊的な変更は行っていない。なので、プロダクションビルド時にのみ行っている。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eminifyJS\u003c/code\u003eは埋め込まれたHyperappの初期state用の設定だ。JSON形式で埋め込まれるため、その余分なクォートを取り除いている。\u003c/p\u003e\n\u003capp-code-wrapper lang=\"diff\" code=\"-var __data = {\u0026#x22;foo\u0026#x22;: \u0026#x22;bar\u0026#x22;}\n+var __data = {foo: \u0026#x22;bar\u0026#x22;}\"\u003e\u003cpre class=\"shiki\" style=\"background-color: #1E1E1E\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #CE9178\"\u003e-var __data = {\u0026quot;foo\u0026quot;: \u0026quot;bar\u0026quot;}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #B5CEA8\"\u003e+var __data = {foo: \u0026quot;bar\u0026quot;}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/app-code-wrapper\u003e\n\u003ch3\u003emarkdown / JSON\u003c/h3\u003e\n\u003capp-code-wrapper lang=\"js\" code=\"{\n  collapseBooleanAttributes: true,\n  // collapseInlineTagWhitespace: true,\n  collapseWhitespace: true,\n  quoteCharacter: \u0026#x60;\u0026#x27;\u0026#x60;,\n  removeAttributeQuotes: true,\n  removeRedundantAttributes: true,\n  sortAttributes: true,\n  sortClassName: true,\n}\"\u003e\u003cpre class=\"shiki\" style=\"background-color: #1E1E1E\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003ecollapseBooleanAttributes\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #6A9955\"\u003e// collapseInlineTagWhitespace: true,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003ecollapseWhitespace\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003equoteCharacter\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #CE9178\"\u003e`\u0026#39;`\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003eremoveAttributeQuotes\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003eremoveRedundantAttributes\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003esortAttributes\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #C8C8C8\"\u003esortClassName\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #D4D4D4\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/app-code-wrapper\u003e\n\u003cp\u003emarkdownは、ホワイトスペースの削除など破壊的になりうる設定を取り入れている。これは、Hyperappの\u003ccode\u003einnerHTML\u003c/code\u003eで入れているためVirtual DOMの管理外であるからだ。こちらは、破壊箇所がないか様子を見るためにプロダクションビルドでない時にもminifyを行っている。（そのうちプロダクションビルド時のみにしたい）\u003c/p\u003e\n\u003cp\u003e最初は、細かい作り込みができないmarkdownでは\u003ccode\u003ecollapseInlineTagWhitespace\u003c/code\u003eの影響を受けることはないだろうと有効にしていた。しかし、\u003ccode\u003e**foo** **bar**\u003c/code\u003eと書いた時に間のスペースが消えることに気づき、またその設定で効果が出るHTMLをmarkdownが生成するとは思えないのでオフにした。\u003c/p\u003e\n\u003cp\u003eまた、このHTMLはJSONの中にも埋め込まれることから、シングルクォート使用するよう設定した。\u003c/p\u003e\n\u003ch2\u003e採用を断念した設定\u003c/h2\u003e\n\u003cp\u003emarkdownで\u003ccode\u003eremoveOptionalTags\u003c/code\u003eというオプションを使用したかったのだが今回の用法では見送った。これは、省略可能なタグを削除するもので、\u003ccode\u003ep\u003c/code\u003eや\u003ccode\u003eli\u003c/code\u003eの終了タグがその対象の1つだ。\u003c/p\u003e\n\u003cp\u003e今回の用法では、markdown時、Hyperapp時と2重にminifyされる。1回目の時に\u003ccode\u003eremoveOptionalTags\u003c/code\u003eを有効にすると、2回目の時にHTMLが正しくパースされなかった。\u003c/p\u003e\n\u003capp-code-wrapper lang=\"html\" code=\"\u003cp\u003e終了タグは省略\n\u003c!-- 終了タグの正しい場所 --\u003e\n\u003cpre\u003e\u003ccode\u003e/* 別のタグ */\u003c/code\u003e\u003c/pre\u003e\n\u003c!-- html-minifierが\u003c/p\u003eを挿入した場所 --\u003e\n\u003cp\u003e別のpタグ\"\u003e\u003cpre class=\"shiki\" style=\"background-color: #1E1E1E\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #808080\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003ep\u003c/span\u003e\u003cspan style=\"color: #808080\"\u003e\u0026gt;\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e終了タグは省略\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #6A9955\"\u003e\u0026lt;!-- 終了タグの正しい場所 --\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #808080\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003epre\u003c/span\u003e\u003cspan style=\"color: #808080\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003ecode\u003c/span\u003e\u003cspan style=\"color: #808080\"\u003e\u0026gt;\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e/* 別のタグ */\u003c/span\u003e\u003cspan style=\"color: #808080\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003ecode\u003c/span\u003e\u003cspan style=\"color: #808080\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003epre\u003c/span\u003e\u003cspan style=\"color: #808080\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #6A9955\"\u003e\u0026lt;!-- html-minifierが\u0026lt;/p\u0026gt;を挿入した場所 --\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #808080\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color: #569CD6\"\u003ep\u003c/span\u003e\u003cspan style=\"color: #808080\"\u003e\u0026gt;\u003c/span\u003e\u003cspan style=\"color: #D4D4D4\"\u003e別のpタグ\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/app-code-wrapper\u003e\n\u003cp\u003e2回目の時にもそのオプションが有効なら間違えて挿入した終了タグも削除された。だが、間違えた状態でminifyされるコードを信頼できないため、\u003ccode\u003eremoveOptionalTags\u003c/code\u003eは行わないことにした。\u003c/p\u003e\n\u003ch2\u003e結果\u003c/h2\u003e\n\u003cp\u003e1つ前の記事\u003ca href=\"/blog/remove-object-key/\"\u003e【ES.next】Objectから任意のキーを削除した新しいObjectを作成する\u003c/a\u003eをminifyした。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth align=\"left\"\u003e設定\u003c/th\u003e\n\u003cth align=\"right\"\u003eHTML\u003c/th\u003e\n\u003cth align=\"right\"\u003eJSON\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd align=\"left\"\u003eHTML minifyなし\u003c/td\u003e\n\u003ctd align=\"right\"\u003e14,170 Byte\u003c/td\u003e\n\u003ctd align=\"right\"\u003e6,275 Byte\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd align=\"left\"\u003e\u003ccode\u003eremoveOptionalTags\u003c/code\u003eなし\u003c/td\u003e\n\u003ctd align=\"right\"\u003e13,872 Byte\u003c/td\u003e\n\u003ctd align=\"right\"\u003e6,088 Byte\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd align=\"left\"\u003e\u003ccode\u003eremoveOptionalTags\u003c/code\u003eあり\u003c/td\u003e\n\u003ctd align=\"right\"\u003e13,722 Byte\u003c/td\u003e\n\u003ctd align=\"right\"\u003e6,037 Byte\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003ccode\u003eremoveOptionalTags\u003c/code\u003eをありにしても元のHTMLの96.8%程度。インデントなしのHTMLをminifyしてもあまり効果はないようだ。\nまた、\u003ccode\u003eremoveOptionalTags\u003c/code\u003eの有無もあまり差はなかった。箇条書きを多用すればもう少し差が開く可能性はあるが、わざわざ有効にするほどでもなさそう。\u003c/p\u003e\n\u003c!-- link --\u003e"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"html-minify"},"buildId":"Gve2BknyuSzfI_yPPf3tt","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>